<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>Event</title>
        <style>
             .ui-outputlabel-rfi { display: none; }
             
              .ui-datalist {
        /*width:300px;*/
        /*margin-bottom: 20px;*/
    }
 
    .ui-datalist-item {
        padding:3px;
    }
 
    .paginated .ui-datalist-data {
        padding: 10px;
    }
        </style>
    </h:head>
    <h:body>

        <ui:include src="templates/navbar.xhtml"></ui:include>

       <h:form class="eventDetailForm" id="mainEventForm">

        <h:panelGroup class="eventDetailsMain">
            <h:panelGroup class="eventDetailsCon">
                <h:panelGroup class="eventDetailsTitle">Event Details</h:panelGroup>
        
                    <h:panelGrid columns="1">
                        <p:outputLabel for="event_name" value="Name: " ></p:outputLabel>
                        <h:panelGroup>
                            <p:inputText id="event_name"       
                            requiredMessage="Please enter your Event Name"
                            required="true"  value="#{eventsCtrl.newEvent_.event_name}"></p:inputText>
                            <p:message for="event_name" />
                        </h:panelGroup>

                        <p:outputLabel for="event_description" value="Description: " ></p:outputLabel>
                        <h:panelGroup>
                            <p:inputTextarea id="event_description" rows="6" cols="33" required="true" 
                                             value="#{eventsCtrl.newEvent_.event_description}"
                                             requiredMessage="Please enter your Event Description"/>
                            <p:message for="event_description" />
                        </h:panelGroup>

                        <p:outputLabel for="start_datetime" value="Start Date &amp; Time: " ></p:outputLabel>
                        <h:panelGroup>
                            <p:calendar id="start_datetime" pattern="dd/MM/yyyy HH:mm" 
                                        mindate="#{eventsCtrl.todayDate}" required="true"
                                        value="#{eventsCtrl.newEvent_.start_datetime}"
                                        requiredMessage="Please enter your Event Start Date &amp; Time"/>
                            <p:message for="start_datetime" />
                        </h:panelGroup>
                        <p:outputLabel for="end_datetime" value="End Date &amp; Time: " ></p:outputLabel>
                         <h:panelGroup>
                            <p:calendar id="end_datetime" pattern="dd/MM/yyyy HH:mm" 
                                        mindate="#{eventsCtrl.minDate}" required="true"
                                        value="#{eventsCtrl.newEvent_.end_datetime}"
                                        requiredMessage="Please enter your Event End Date &amp; Time"/>
                            <p:message for="end_datetime" />
                        </h:panelGroup>
                    </h:panelGrid>
            </h:panelGroup>


            <h:panelGroup class="userSearchCon" id="newEventGuestList">
                <h:panelGroup class="eventDetailsGuestsTitle">Guests</h:panelGroup>
                    <h:panelGroup class="searchEventContactForm">
                        <p:inputText class="searchEventContactInput" required="false" placeholder="Search">
                            <p:ajax event="keyup" listener="#{searchCtrl.searchForContactsAjax}" 
                                    process="@this" update=":mainEventForm:usersTable"></p:ajax>
                        </p:inputText>      
                    </h:panelGroup>
                
                    <p:dataList style="padding: 10px;" value="#{searchCtrl.contactUsers}" id="usersTable" itemType="none" var="user" paginator="true" rows="10" styleClass="paginated" paginatorAlwaysVisible="false" paginatorPosition="bottom">
                       <h:panelGroup class="guestListCon">
                            <h:outputText class="guestListName" value="#{user.firstname}, #{user.lastname}" style="display:inline-block"/>
                            <p:commandButton  class="guestlistBtn" immediate="true" update=":mainEventForm:newEventGuestList" value="Add" ajax="true" action="#{eventsCtrl.addGuestToNewEvent(user)}"/>            
                        </h:panelGroup> 
                   </p:dataList>
                
                <p:dataList value="#{eventsCtrl.newEvent_.guests}" itemType="none" var="user" paginator="true" rows="10" styleClass="paginated" paginatorAlwaysVisible="false" paginatorPosition="bottom">
                        <h:panelGroup class="guestListCon">
                            <h:outputText class="guestListName" value="#{user.firstname}, #{user.lastname}" style="display:inline-block"/>
                            <p:commandButton class="guestlistBtn" immediate="true" update=":mainEventForm:newEventGuestList" value="Remove" ajax="true" action="#{eventsCtrl.removeGuestFromNewEvent(user)}"/>            
                        </h:panelGroup>
                    </p:dataList>
                 
            </h:panelGroup>
            <h:panelGroup class="createbtnCon">
                <p:commandButton class="addEventBtn"  update=":mainEventForm" value="Create" ajax="true" action="#{eventsCtrl.createNewEvent()}"/>            
            </h:panelGroup>
        </h:panelGroup>
        </h:form>

    </h:body>
</html>

